struct Printer<T> {
    print_fun: fn(T),
}

impl Printer {
    fn new<T>(print_fun: fn(T)) -> Printer<T> {
        Printer { print_fun: print_fun }
    }

    fn print<T>(self: &Printer<T>, val: T) {
        let a = self.print_fun;
        a(val);
    }
}


#[export]
fn main(argc: i32, argv: &&u8) {
    let pr = Printer::new(write_number::<i64>);

    pr.print(54);
}
